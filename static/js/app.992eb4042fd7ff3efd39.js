webpackJsonp([1],{"+QOH":function(t,e){},"991W":function(t,e){},EhEg:function(t,e){},NHnr:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("7+uW"),s={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var a=i("VU/8")({name:"App"},s,!1,function(t){i("zePU")},null,null).exports,l=i("/ocq"),o=i("PG4T"),r=i.n(o),c={props:{modalStatus:{type:Boolean,required:!0,default:!1},editText:{type:String,default:""},textId:{default:""}},data:function(){return{textarea:""}},watch:{editText:function(t,e){this.textarea=t}},methods:{close:function(){this.$emit("closeModal",!1)},confirm:function(){this.$emit("closeModal",!1),this.$emit("confirmModal",{text:this.textarea,textId:this.textId}),this.textarea=""}}},d={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"show",rawName:"v-show",value:t.modalStatus,expression:"modalStatus"}],staticClass:"modal-template"},[i("div",{staticClass:"modal"},[""===t.textId?i("div",{staticClass:"modal-title"},[t._v("\n            添加文字\n        ")]):i("div",{staticClass:"modal-title"},[t._v("\n            编辑文字\n        ")]),t._v(" "),i("div",{staticClass:"modal-contain"},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.textarea,expression:"textarea"}],attrs:{name:""},domProps:{value:t.textarea},on:{input:function(e){e.target.composing||(t.textarea=e.target.value)}}})]),t._v(" "),i("div",{staticClass:"modal-footer"},[i("button",{staticClass:"disable",on:{click:t.close}},[t._v("取消")]),t._v(" "),i("button",{staticClass:"confirm",on:{click:t.confirm}},[t._v("确定")])])]),t._v(" "),i("div",{staticClass:"modal-shade"})])},staticRenderFns:[]};var u=i("VU/8")(c,d,!1,function(t){i("X5FS")},"data-v-0f94304e",null).exports,v={props:{delModalStatus:{type:Boolean,required:!0,default:!1},imgId:{default:""}},data:function(){return{}},methods:{close:function(){this.$emit("closeDelModal",!1)},confirm:function(){this.$emit("closeDelModal",!1),this.$emit("confirmDelModal",{imgId:this.imgId})}}},f={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"show",rawName:"v-show",value:t.delModalStatus,expression:"delModalStatus"}],staticClass:"modal-template"},[i("div",{staticClass:"modal"},[i("div",{staticClass:"modal-title"},[t._v("\n            删除图片\n        ")]),t._v(" "),t._m(0),t._v(" "),i("div",{staticClass:"modal-footer"},[i("button",{staticClass:"disable",on:{click:t.close}},[t._v("取消")]),t._v(" "),i("button",{staticClass:"confirm",on:{click:t.confirm}},[t._v("确定")])])]),t._v(" "),i("div",{staticClass:"modal-shade"})])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal-contain"},[e("p",[this._v("确认删除该图片？")])])}]};var m=i("VU/8")(v,f,!1,function(t){i("kvtP")},"data-v-3cce59ab",null).exports,h=new n.a,p={components:{"v-modal":u,"v-delModal":m},mounted:function(){if(Array.isArray(h.list)&&h.list.length>0)try{var t=h.list;this.getIdAndSet(t),this.list=t}catch(t){this.list=[]}else this.list=[];h.btnStatus=!1},data:function(){return{openModal:!1,openDelModal:!1,imgReg:/\.(png|jpe?g|gif|svg)(\?.*)?$/i,textId:0,imgId:0,list:[],currentModalText:"",currentModalTextId:"",currentImgId:"",btnStatus:h.btnStatus,btnText:h.btnStatus?"生成中...":"生成图片"}},methods:{getIdAndSet:function(t){var e=t.filter(function(t,e){return"img"===t.type}),i=t.filter(function(t,e){return"text"===t.type});i.length>0&&(this.textId=i[i.length-1].id),e.length>0&&(this.imgId=e[e.length-1].id)},getImage:function(){if(this.list.length<=0)return alert("请先添加图片或文字！"),!1;if(!0===h.btnStatus)return!1;window.scrollTo(0,0);var t=this;h.btnStatus=!0,r()(this.$refs.ul).then(function(e){t.setStore(),h.htmlCanvas=e.toDataURL("image/jpeg"),t.$router.push({name:"render"})})},addText:function(){this.openModal=!0},close:function(){this.openModal=!1,this.currentModalText="",this.currentModalTextId=""},getText:function(t){if(""===t.textId)this.list.push({type:"text",value:t.text,id:this.textId++});else{var e=this.list.find(function(e,i){return"text"==e.type&&e.id==t.textId}),i=this.list.indexOf(e);if(""===t.text)return void this.list.splice(i,1);this.list[i].value=t.text}this.setStore()},addImg:function(){this.$refs.input.value="",this.$refs.input.click()},getFile:function(t){for(var e=t.target.files,i=e.length,n=this,s=0;s<i;s++)if(this.imgReg.test(e[s].name)){var a=new FileReader;a.readAsDataURL(e[s]),a.onload=function(t){n.list.push({type:"img",value:this.result,id:n.imgId++}),a=null}}this.setStore()},editPText:function(t,e){this.openModal=!0,this.currentModalText=t,this.currentModalTextId=e},showDelModal:function(t){this.currentImgId=t,this.openDelModal=!0},closeDel:function(){this.openDelModal=!1},delImg:function(t){var e=this.list.find(function(e,i){return"img"===e.type&&e.id==t.imgId}),i=this.list.indexOf(e);this.list.splice(i,1)},setStore:function(){h.list=this.list},clearAll:function(){this.list=[],h.list=[],h.htmlCanvas=""}}},g={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"list"},[t.list.length>0?i("ul",{ref:"ul"},t._l(t.list,function(e,n){return i("li",{key:n,class:e.type},["text"===e.type?i("p",{on:{click:function(i){t.editPText(e.value,e.id)}}},[t._v(t._s(e.value))]):i("img",{attrs:{src:e.value,alt:""},on:{click:function(i){t.showDelModal(e.id)}}})])})):i("div",{staticClass:"null"},[t._v("\n        快添加文字或照片吧\n    ")]),t._v(" "),i("div",{staticClass:"helper"}),t._v(" "),i("div",{staticClass:"fixed-nav"},[i("button",{on:{click:t.addText}},[t._v("添加文字")]),t._v(" "),i("button",{on:{click:t.addImg}},[t._v("添加照片")]),t._v(" "),i("input",{ref:"input",staticClass:"file",attrs:{type:"file"},on:{change:function(e){t.getFile(e)}}}),t._v(" "),i("button",{on:{click:t.clearAll}},[t._v("清除全部")]),t._v(" "),i("button",{on:{click:t.getImage}},[t._v(t._s(t.btnText))])]),t._v(" "),i("v-modal",{attrs:{modalStatus:t.openModal,editText:t.currentModalText,textId:t.currentModalTextId},on:{closeModal:t.close,confirmModal:t.getText}}),t._v(" "),i("v-delModal",{attrs:{delModalStatus:t.openDelModal,imgId:t.currentImgId},on:{closeDelModal:t.closeDel,confirmDelModal:t.delImg}})],1)},staticRenderFns:[]};var x=i("VU/8")(p,g,!1,function(t){i("+QOH")},null,null).exports,_={mounted:function(){h.btnStatus=!1,this.renderImg()},data:function(){return{imgSrc:""}},methods:{renderImg:function(){var t=h.htmlCanvas;"string"==typeof t&&t.length>0?this.imgSrc=t:this.$router.push("/")},back:function(){this.$router.push("/")}}},I={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"renderImg"},[e("div",{staticClass:"back",on:{click:this.back}},[this._v(" 《 返回")]),this._v(" "),e("img",{attrs:{src:this.imgSrc,alt:""}})])},staticRenderFns:[]};var M=i("VU/8")(_,I,!1,function(t){i("EhEg")},null,null).exports;n.a.use(l.a);var C=new l.a({routes:[{path:"/",name:"list",component:x},{path:"/render",component:M,name:"render"}]});i("991W");n.a.config.productionTip=!1,new n.a({el:"#app",router:C,components:{App:a},template:"<App/>"})},X5FS:function(t,e){},kvtP:function(t,e){},zePU:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.992eb4042fd7ff3efd39.js.map